<!DOCTYPE html>
<html lang="en" theme="light">

<head>
    <meta charset="UTF-8">
    <title>CO2 Gadget Status</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script>
        // Immediately set the theme based on localStorage before the CSS is loaded
        (function () {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('theme', savedTheme);
            }
        })();
    </script>
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <script defer type="text/javascript" src="./status.js"></script>
</head>

<body>
    <!-- Navigation bar -->
    <div class="navbar" id="navbar">
        <div class="nav-content">
            <div class="nav-links-left">
                <a href="index.html">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 576 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z" />
                    </svg>
                    <span>Home</span>
                </a>
                <a href="preferences.html">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z" />
                    </svg>
                    <span>Preferences</span>
                </a>
                <a href="low_power.html" class="hidden" id="lowPowerLink">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                        <path
                            d="M0 256L28.5 28c2-16 15.6-28 31.8-28H228.9c15 0 27.1 12.1 27.1 27.1c0 3.2-.6 6.5-1.7 9.5L208 160H347.3c20.2 0 36.7 16.4 36.7 36.7c0 7.4-2.2 14.6-6.4 20.7l-192.2 281c-5.9 8.6-15.6 13.7-25.9 13.7h-2.9c-15.7 0-28.5-12.8-28.5-28.5c0-2.3 .3-4.6 .9-6.9L176 288H32c-17.7 0-32-14.3-32-32z" />
                    </svg>
                    <span>Low Power</span>
                </a>
                <a href="status.html">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z" />
                    </svg>
                    <span>Status</span>
                </a>
            </div>
            <div class="nav-links-right">
                <a href="ota.html" class="hidden" id="otaLink">
                    <svg xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.-->
                        <path
                            d="M288 109.3V352c0 17.7-14.3 32-32 32s-32-14.3-32-32V109.3l-73.4 73.4c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l128-128c12.5-12.5 32.8-12.5 45.3 0l128 128c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L288 109.3zM64 352H192c0 35.3 28.7 64 64 64s64-28.7 64-64H448c35.3 0 64 28.7 64 64v32c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V416c0-35.3 28.7-64 64-64zM432 456a24 24 0 1 0 0-48 24 24 0 1 0 0 48z" />
                    </svg>
                    <span>OTA</span>
                </a>
                <a href="/getCaptivePortalStatusAsJson">
                    <span id="server-status-dot" class="status-dot status-dot-hidden"
                        title="Captive portal inactive"></span>
                </a>
                <!-- Theme Switch Icon -->
                <div class="iconDarkLight" id="iconBulb">
                    <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <path id="iconPath" fill="currentColor"></path>
                    </svg>
                </div>
            </div>
        </div>
        <!-- Captive Portal Status Container -->
        <div id="captive-portal-status-bar" class="captive-portal-status-bar hidden-captive-portal-status-bar"></div>
    </div>
    
    <!-- Debug Window Container -->
    <div id="debug-window" class="debug-window hidden-debug-window"></div>

    <div class="content">
        <h1>CO2 Gadget Status</h1>

        <fieldset>
            <legend>CO2 Gadget Sensors:</legend>
            <div class="status-item" id="mainDeviceSelectedItem">
                <span class="status-label">Sensor Selected:</span> <span id="mainDeviceSelected"></span>
            </div>
            <div class="status-item" id="co2Item">
                <span class="status-label">CO2:</span> <span id="co2"></span> ppm
            </div>
            <div class="status-item" id="temperatureItem">
                <span class="status-label">Temperature:</span> <span id="temperature"></span> ÂºC
            </div>
            <div class="status-item" id="humidityItem">
                <span class="status-label">Humidity:</span> <span id="humidity"></span> %RH
            </div>
            <div class="status-item" id="measurementIntervalItem">
                <span class="status-label">Sensor Measurement Interval:</span> <span id="measurementInterval"></span> secs.
            </div>
            <div class="status-item" id="sampleIntervalItem">
                <span class="status-label">BLE Sample Interval (MyAmbiance):</span> <span id="sampleInterval"></span> secs.
            </div>
        </fieldset>

        <!-- Communications Group -->
        <fieldset>
            <legend>CO2 Gadget Communications:</legend>
            <div class="status-item" id="wifiStatusItem">
                <span class="status-label">WiFi Status:</span> <span id="wifiStatus"></span>
            </div>
            <div class="status-item" id="ssidItem">
                <span class="status-label">SSID:</span> <span id="ssid"></span>
            </div>
            <div class="status-item" id="wifiPassItem">
                <span class="status-label">WiFi Password:</span> <span id="wifiPass"></span>
            </div>
            <div class="status-item" id="ipItem">
                <span class="status-label">IP Address:</span> <span id="ip"></span>
            </div>
            <div class="status-item" id="rssiItem">
                <span class="status-label">RSSI:</span> <span id="rssi"></span>
            </div>
            <div class="status-item" id="macAddressItem">
                <span class="status-label">MAC Address:</span> <span id="macAddress"></span>
            </div>
            <div class="status-item" id="hostNameItem">
                <span class="status-label">Host Name:</span> <span id="hostName"></span>
            </div>
            <div class="status-item" id="useStaticIPItem">
                <span class="status-label">Use Static IP:</span> <span id="useStaticIP"></span>
            </div>
            <div class="status-item" id="staticIPItem">
                <span class="status-label">Static IP:</span> <span id="staticIP"></span>
            </div>
            <div class="status-item" id="gatewayItem">
                <span class="status-label">Gateway:</span> <span id="gateway"></span>
            </div>
            <div class="status-item" id="subnetItem">
                <span class="status-label">Subnet:</span> <span id="subnet"></span>
            </div>
            <div class="status-item" id="dns1Item">
                <span class="status-label">DNS1:</span> <span id="dns1"></span>
            </div>
            <div class="status-item" id="dns2Item">
                <span class="status-label">DNS2:</span> <span id="dns2"></span>
            </div>
            <div class="status-item" id="rootTopicItem">
                <span class="status-label">Root Topic:</span> <span id="rootTopic"></span>
            </div>
            <div class="status-item" id="discoveryTopicItem">
                <span class="status-label">Discovery Topic:</span> <span id="discoveryTopic"></span>
            </div>
            <div class="status-item" id="mqttClientIdItem">
                <span class="status-label">MQTT Client ID:</span> <span id="mqttClientId"></span>
            </div>
            <div class="status-item" id="mqttBrokerItem">
                <span class="status-label">MQTT Broker:</span> <span id="mqttBroker"></span>
            </div>
            <div class="status-item" id="mqttUserItem">
                <span class="status-label">MQTT User:</span> <span id="mqttUser"></span>
            </div>
            <div class="status-item" id="mqttPassItem">
                <span class="status-label">MQTT Password:</span> <span id="mqttPass"></span>
            </div>
            <div class="status-item" id="peerESPNowAddressItem">
                <span class="status-label">Peer ESPNow Address:</span> <span id="peerESPNowAddress"></span>
            </div>
            <div class="status-item" id="activeWiFiItem">
                <span class="status-label">Active WiFi:</span> <span id="activeWiFi"></span>
            </div>
            <div class="status-item" id="activeMQTTItem">
                <span class="status-label">Active MQTT:</span> <span id="activeMQTT"></span>
            </div>
            <div class="status-item" id="activeBLEItem">
                <span class="status-label">Active BLE:</span> <span id="activeBLE"></span>
            </div>
            <div class="status-item" id="activeOTAItem">
                <span class="status-label">Active OTA:</span> <span id="activeOTA"></span>
            </div>
            <div class="status-item" id="troubledWiFiItem">
                <span class="status-label">Troubled WiFi:</span> <span id="troubledWiFi"></span>
            </div>
            <div class="status-item" id="troubledMQTTItem">
                <span class="status-label">Troubled MQTT:</span> <span id="troubledMQTT"></span>
            </div>
            <div class="status-item" id="troubledESPNowItem">
                <span class="status-label">Troubled ESPNow:</span> <span id="troubledESPNow"></span>
            </div>
        </fieldset>

        <!-- Calibration Group -->
        <fieldset>
            <legend>CO2 Gadget Calibration:</legend>
            <div class="status-item" id="calibrationValueItem">
                <span class="status-label">Calibration Value:</span> <span id="calibrationValue"></span> ppm
            </div>
            <div class="status-item" id="pendingCalibrationItem">
                <span class="status-label">Pending Calibration:</span> <span id="pendingCalibration"></span>
            </div>
        </fieldset>

        <!-- Low Power Options Group -->
        <fieldset id="lowPowerOptionsFieldset" class="hidden">
            <legend>Low Power Options:</legend>
            <div class="status-item" id="lowPowerModeItem">
                <span class="status-label">Low Power Mode:</span> <span id="lowPowerMode"></span>
            </div>
            <div class="status-item" id="waitToDeepItem">
                <span class="status-label">Wait To Deep Sleep:</span> <span id="waitToDeep"></span> secs
            </div>
            <div class="status-item" id="timeSleepingItem">
                <span class="status-label">Time Sleeping:</span> <span id="timeSleeping"></span> secs
            </div>
            <div class="status-item" id="cyclsWifiConnItem">
                <span class="status-label">Cycles WiFi Connected:</span> <span id="cyclsWifiConn"></span>
            </div>
            <div class="status-item" id="cycRedrawDisItem">
                <span class="status-label">Cycles Redraw Display:</span> <span id="cycRedrawDis"></span>
            </div>
            <div class="status-item" id="actBLEOnWakeItem">
                <span class="status-label">Activate BLE on Wake:</span> <span id="actBLEOnWake"></span>
            </div>
            <div class="status-item" id="actWifiOnWakeItem">
                <span class="status-label">Activate WiFi on Wake:</span> <span id="actWifiOnWake"></span>
            </div>
            <div class="status-item" id="actMQTTOnWakeItem">
                <span class="status-label">Activate MQTT on Wake:</span> <span id="actMQTTOnWake"></span>
            </div>
            <div class="status-item" id="actESPnowWakeItem">
                <span class="status-label">Activate ESPNow on Wake:</span> <span id="actESPnowWake"></span>
            </div>
            <div class="status-item" id="displayOnWakeItem">
                <span class="status-label">Display on Wake:</span> <span id="displayOnWake"></span>
            </div>
        </fieldset>

        <!-- System Group -->
        <fieldset>
            <legend>CO2 Gadget System:</legend>
            <div class="status-item" id="freeHeapItem">
                <span class="status-label">Free Heap:</span> <span id="freeHeap"></span> bytes
            </div>
            <div class="status-item" id="minFreeHeapItem">
                <span class="status-label">Min Free Heap:</span> <span id="minFreeHeap"></span> bytes
            </div>
            <div class="status-item" id="uptimeItem">
                <span class="status-label">Uptime:</span> <span id="uptime"></span>
            </div>
        </fieldset>

        <!-- Captive Portal Group -->
        <fieldset>
            <legend>Captive Portal:</legend>
            <div class="status-item" id="captivePortalActiveItem">
                <span class="status-label">Captive Portal Active:</span> <span id="captivePortalActive"></span>
            </div>
            <div class="status-item" id="timeCaptivePortalStartedItem">
                <span class="status-label">Time Captive Portal Started:</span> <span
                    id="timeCaptivePortalStarted"></span>
            </div>
            <div class="status-item" id="timeToWaitForCaptivePortalItem">
                <span class="status-label">Time To Wait For Captive Portal:</span> <span
                    id="timeToWaitForCaptivePortal"></span>
            </div>
            <div class="status-item" id="captivePortalTimeLeftItem">
                <span class="status-label">Captive Portal Time Left:</span> <span id="captivePortalTimeLeft"></span>
            </div>
            <div class="status-item" id="captivePortalDebugItem">
                <span class="status-label">Captive Portal Debug:</span> <span id="captivePortalDebug"></span>
            </div>
            <div class="status-item" id="relaxedSecurityItem">
                <span class="status-label">Relaxed Security:</span> <span id="relaxedSecurity"></span>
            </div>
        </fieldset>

        <!-- Features Group -->
        <fieldset>
            <legend>Features (compilation time):</legend>
            <div class="feature-item" id="featureBLEItem">
                <span class="feature-label">BLE:</span> <span id="featureBLE"></span>
            </div>
            <div class="feature-item" id="featureBuzzerItem">
                <span class="feature-label">Buzzer:</span> <span id="featureBuzzer"></span>
            </div>
            <div class="feature-item" id="featureESPNowItem">
                <span class="feature-label">ESPNow:</span> <span id="featureESPNow"></span>
            </div>
            <div class="feature-item" id="featureMDNSItem">
                <span class="feature-label">mDNS:</span> <span id="featureMDNS"></span>
            </div>
            <div class="feature-item" id="featureMQTTItem">
                <span class="feature-label">MQTT:</span> <span id="featureMQTT"></span>
            </div>
            <div class="feature-item" id="featureMQTTDiscoveryItem">
                <span class="feature-label">Discovery:</span> <span id="featureMQTTDiscovery"></span>
            </div>
            <div class="feature-item" id="featureOTAItem">
                <span class="feature-label">OTA:</span> <span id="featureOTA"></span>
            </div>
            <div class="feature-item" id="featureLowPowerItem" class="hidden">
                <span class="feature-label">Low power:</span> <span id="featureLowPower"></span>
            </div>
        </fieldset>
    </div>

    <!-- Status line to display CO2 Gadget version -->
    <div id="statusLineContainer">
        <span id="co2GadgetVersion"></span>
    </div>
</body>

</html>